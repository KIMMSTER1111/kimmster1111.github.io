<html>
<head>
<title>Funky Zombie Killer</title>
</head>
<body onload="init()">
<canvas id="map" width="1100" height="600"></canvas>
<script>


var c = document.getElementById("map");
var ctx = c.getContext("2d");
var map = new Image();
var heroX = 30;
var heroY = 200;
var hero = new Image();
var bulletImg = new Image();
var zombieImg = new Image();
var blood = new Image();
var zombieDeadImg = new Image();

//Zombie class
function zombie(x,y,dead) {
	this.x = x;
	this.y = y;
	this.dead = dead;
};
//Bullet class
function bullet(x,y,exists) {
	this.x = x;
	this.y = y;
	this.exists = exists;
}
//Create zombie instance - for now.  This should be updated
var z1 = new zombie(800,200,false);

//Initial function to set shit up
function init() {
	blood.src = 'blood.png';
	map.src = 'map.png';
	hero.src = 'hero.png';
	bulletImg.src = 'bullet.png';
	zombieImg.src = 'zombie.png';
	zombieDeadImg.src = 'zombieDead.png';
        ctx.drawImage(map, 0, 0);
		ctx.drawImage(zombieImg, 800, 200); //hardcoding x and y for now. Remember to change this
		ctx.drawImage(hero, 30,200);
		
		
	 gameLoop = setInterval(doGameLoop, 20);

	 window.addEventListener('keydown', whatKey, true);
	  }
	
//Main loop to listen for keypresses and check for collisions, etc
function doGameLoop() {
	hero.src = 'hero.png';
	ctx.drawImage(map, 0,0);
    ctx.drawImage(hero, heroX, heroY);
	if(z1.dead){ 
		ctx.drawImage(zombieDeadImg, z1.x, z1.y);
	} else {
		ctx.drawImage(zombieImg, z1.x, z1.y);
	}
		
	if(b1.exists) { //this needs to be made into a general case (maybe for loop?)
		ctx.drawImage(bulletImg, b1.x, b1.y);
		b1.x += 30;
			if(b1.x > 1100) {
				b1.exists = false;
			}
		}
		if(b1.x > z1.x && b1.y > z1.y && b1.y < z1.y + 260 && b1.exists) {
			b1.exists = false;
			ctx.drawImage(blood, z1.x  + 100, b1.y); //this should probably exist for longer than 20ms
			z1.dead = true;
		}

      }
	  // Get key press.


      function whatKey(evt) {

        switch (evt.keyCode) {
		case 32:
		fireBullet();
		break;

          // Left arrow.
        case 37:
          heroX = heroX - 30;
          if (heroX < 0) {
            // If at edge, reset position.
            heroX = 0;
          }
          break;

          // Right arrow.
        case 39:
          heroX = heroX + 30;
          if (heroX > 420) {
            // If at edge, reset position.
            heroX = 420;
          }
          break;

          // Down arrow
        case 40:
          heroY = heroY + 30;
          if (heroY > 510) {
            // If at edge, reset position.
            heroY = 510;
          }
          break;

          // Up arrow 
        case 38:
          heroY = heroY - 30;
          if (heroY < 0) {
            // If at edge, reset position.
            heroY = 0;
          }
          break;

        }
      }
	function fireBullet() {
		//create instance of bullet. this will need to be fixed so it can handle more than one
		window.b1 = new bullet(heroX + 172, heroY + 65, true); //this function should maybe be scrapped so that this variable doesn't need to be global
	}
	 
</script>
</body>
</html>